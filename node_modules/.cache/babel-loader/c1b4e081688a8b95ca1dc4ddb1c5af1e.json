{"ast":null,"code":"import { ADD_TO_CART, REMOVE_FROM_CART, CHANGE_QUANTITY, USE_COUPON, TO_CHECKOUT, ON_CHECKOUT } from '../actions/cart-actions';\nimport productsData from '../data/products.json';\nimport couponsData from '../data/coupons.json';\nconst shippingPrice = 8;\nconst initialState = {\n  products: productsData,\n  coupons: couponsData,\n  discountCoupon: {},\n  cartItems: [],\n  checkoutData: {},\n  shippingCost: shippingPrice\n};\n\nconst cartReducer = function (state = initialState, action) {\n  switch (action.type) {\n    case ADD_TO_CART:\n      if (state.cartItems.find(product => product.item.id === action.id && product.item.stock <= product.quantity)) {\n        window.alert('Number of items in stock exceded!');\n        return state;\n      } else if (state.cartItems.find(product => product.item.id === action.id)) {\n        const updatedCartItems = state.cartItems.map(product => product.item.id === action.id ? Object.assign({}, product, {\n          quantity: ++product.quantity\n        }) : product);\n        return Object.assign({}, state, {\n          cartItems: updatedCartItems\n        });\n      } else {\n        const addedItem = {\n          quantity: 1,\n          item: state.products.find(product => product.id === action.id)\n        };\n        const updatedCartItems = [...state.cartItems, addedItem];\n        return Object.assign({}, state, {\n          cartItems: updatedCartItems\n        });\n      }\n\n      ;\n\n    case REMOVE_FROM_CART:\n      const updatedCartItems = state.cartItems.filter(product => product.item.id !== action.id);\n      return Object.assign({}, state, {\n        cartItems: updatedCartItems\n      });\n\n    case CHANGE_QUANTITY:\n      if (state.cartItems.find(product => product.item.id === action.id && product.item.stock < action.quantity)) {\n        window.alert('Number of items in stock exceded!');\n        const changedCartItems = state.cartItems.map(product => product.item.id === action.id ? Object.assign({}, product, {\n          quantity: product.item.stock\n        }) : product);\n        return Object.assign({}, state, {\n          cartItems: changedCartItems\n        });\n      } else if (action.quantity <= 0) {\n        return state;\n      } else {\n        const changedCartItems = state.cartItems.map(product => product.item.id === action.id ? Object.assign({}, product, {\n          quantity: action.quantity\n        }) : product);\n        return Object.assign({}, state, {\n          cartItems: changedCartItems\n        });\n      }\n\n    case USE_COUPON:\n      if (state.coupons.find(coupon => coupon.code === action.couponCode)) {\n        const usedCoupon = state.coupons.find(coupon => coupon.code === action.couponCode);\n        return Object.assign({}, state, {\n          discountCoupon: usedCoupon\n        });\n      } else {\n        return state;\n      }\n\n    case TO_CHECKOUT:\n      const checkoutData = {\n        shippingPrice: state.discountCoupon.type === 'shipping' || action.subtotal > 120 ? 0 : state.shippingCost,\n        cartItems: state.cartItems,\n        discountCoupon: state.discountCoupon,\n        subtotal: action.subtotal\n      };\n      return Object.assign({}, state, {\n        checkoutData\n      });\n\n    case ON_CHECKOUT:\n      return Object.assign({}, state, {\n        discountCoupon: {},\n        cartItems: [],\n        shippingCost: shippingPrice\n      });\n\n    default:\n      return state;\n  }\n\n  ;\n};\n\nexport default cartReducer;","map":{"version":3,"sources":["/Users/damiankieltyka/Developer/WebStorm Projects/online-store-react/src/reducers/cart-reducer.js"],"names":["ADD_TO_CART","REMOVE_FROM_CART","CHANGE_QUANTITY","USE_COUPON","TO_CHECKOUT","ON_CHECKOUT","productsData","couponsData","shippingPrice","initialState","products","coupons","discountCoupon","cartItems","checkoutData","shippingCost","cartReducer","state","action","type","find","product","item","id","stock","quantity","window","alert","updatedCartItems","map","Object","assign","addedItem","filter","changedCartItems","coupon","code","couponCode","usedCoupon","subtotal"],"mappings":"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","sourcesContent":["import { ADD_TO_CART, REMOVE_FROM_CART, CHANGE_QUANTITY, USE_COUPON, TO_CHECKOUT, ON_CHECKOUT } from '../actions/cart-actions';\nimport productsData from '../data/products.json';\nimport couponsData from '../data/coupons.json';\n\nconst shippingPrice = 8;\nconst initialState = {\n    products: productsData,\n    coupons: couponsData,\n    discountCoupon: {},\n    cartItems: [],\n    checkoutData: {},\n    shippingCost: shippingPrice\n};\n\nconst cartReducer = function(state = initialState, action) {\n    switch (action.type) {\n        case ADD_TO_CART:\n            if (state.cartItems.find(product => (product.item.id === action.id) && (product.item.stock <= product.quantity))) {\n                window.alert('Number of items in stock exceded!');\n                return state;\n            }\n            else if (state.cartItems.find(product => product.item.id === action.id)) {\n                const updatedCartItems = state.cartItems.map(product => product.item.id === action.id ? Object.assign({}, product, {quantity: ++product.quantity}) : product);\n                return Object.assign({}, state, {cartItems: updatedCartItems});\n            }\n            else {\n                const addedItem = {\n                    quantity: 1,\n                    item: state.products.find(product => product.id === action.id)\n                };\n                const updatedCartItems = [...state.cartItems, addedItem];\n                return Object.assign({}, state, {cartItems: updatedCartItems});\n            };\n\n        case REMOVE_FROM_CART:\n            const updatedCartItems = state.cartItems.filter(product => product.item.id !== action.id);\n            return Object.assign({}, state, {cartItems: updatedCartItems});\n\n        case CHANGE_QUANTITY:\n            if (state.cartItems.find(product => (product.item.id === action.id) && (product.item.stock < action.quantity))) {\n                window.alert('Number of items in stock exceded!');\n                const changedCartItems = state.cartItems.map(product => product.item.id === action.id ? Object.assign({}, product, {quantity: product.item.stock}) : product);\n                return Object.assign({}, state, {cartItems: changedCartItems});\n            }\n            else if (action.quantity <= 0) {\n                return state;\n            }\n            else {\n                const changedCartItems = state.cartItems.map(product => product.item.id === action.id ? Object.assign({}, product, {quantity: action.quantity}) : product);\n                return Object.assign({}, state, {cartItems: changedCartItems});\n            }\n\n        case USE_COUPON:\n            if (state.coupons.find(coupon => coupon.code === action.couponCode)) {\n                const usedCoupon = state.coupons.find(coupon => coupon.code === action.couponCode);\n                return Object.assign({}, state, {discountCoupon: usedCoupon});\n            }\n            else {\n                return state;\n            }\n\n        case TO_CHECKOUT:\n            const checkoutData = {\n                shippingPrice: state.discountCoupon.type === 'shipping' || action.subtotal > 120 ? 0 : state.shippingCost,\n                cartItems: state.cartItems,\n                discountCoupon: state.discountCoupon,\n                subtotal: action.subtotal\n            }\n            return Object.assign({}, state, {checkoutData});\n\n        case ON_CHECKOUT:\n            return Object.assign({}, state, {discountCoupon: {}, cartItems: [], shippingCost: shippingPrice});\n\n        default:\n            return state;\n    };\n};\n\nexport default cartReducer;\n"]},"metadata":{},"sourceType":"module"}